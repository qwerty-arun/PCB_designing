# Reference: [YT tutorial](https://www.youtube.com/watch?v=S_p0YV-JlfU&list=PLXvLToQzgzdehgGIB_mJdwagVTa91w8_s&index=2&t=2725s)
# Here are all the learnings so far:
## Schematic
- [Espressif](https://www.espressif.com/en/products/socs/esp32)
- [Data Sheet](https://www.espressif.com/sites/default/files/documentation/esp32-wroom-32e_esp32-wroom-32ue_datasheet_en.pdf)
- [All documents](https://docs.espressif.com/projects/esp-dev-kits/en/latest/esp32/esp32-devkitc/index.html)
- [Schematics 1](https://dl.espressif.com/dl/schematics/esp32_devkitc_v4_sch.pdf)
- [Schematics 2](https://dl.espressif.com/dl/schematics/ESP32-S2-DevKitM-1_V1_Schematics.pdf)
- [Part: ESP 32 Module](https://www.lcsc.com/product-detail/WiFi-Modules_Espressif-Systems-ESP32-WROOM-32E-N8_C701342.html)
- [UART related](https://www.lcsc.com/product-detail/USB-Converters_SKYWORKS-SILICON-LABS-CP2102N-A02-GQFN28R_C964632.html)
- [Regulator](https://www.lcsc.com/product-detail/Voltage-Regulators-Linear-Low-Drop-Out-LDO-Regulators_UMW-Youtai-Semiconductor-Co-Ltd-AMS1117-3-3_C347222.html)  We want more current so, we choose 1A. 
- [usb connector](https://www.lcsc.com/product-detail/span-style-background-color-ff0-USB-span-Connectors_MOLEX-1050170001_C136000.html).
- Diodes:LESD5D5.0CT1G
- Transistors: SS8050-G
- Choose manufactures such that they have more parts in stock.
- Switches: Tactile switches: C&K: smd,6x6 : PTS645SL13SMTR92LFS
- Capacitors: Multilayer Ceramic Capacitors: Samsung: 0402: 10nF: Basic Part
- Often values in the schematics might be wrong, so do check the datasheet to see what manufacturers recommend. This is a good way to make sure you don't design the circuit the wrong way.
- Resistors: Chip Resistors: uni-royal : 0402
- You can copy the manufacturer no and paste it in the library, change the numbers and get a part of different value.
- 5.1k seems to be good enough for enough current to pass through LED.
- Basic parts are cheaper for assembly.
- If snap mode is off for some reason, turn it on immediately.
- Labelling all the pins of the ESP32 Board done.
- NC: No connection.
- NF: Not fitted (my convention).
- For labels too, make it a habit that you mention what voltages you will be using.
- What are decoupling capacitors?
- Just in case you need some filtering, add a capacitor.
- Refer to datasheets for types of pins, they may be I, O or even I/O. So make sure you always cross check. Sometimes, it won't be mentioned in schematics.
- Using jumpers, pin headers. Why though? So that we get direct supply of external 5V.
- The whole point of the pin header is to make it easy to switch bewteen different power supplies using a jumper.
- Adding a small resistance -> Series termination, it can be helpful to minimise reflections and improve quality of signal. The reason is, in our application, the signal is splitting to different places.
- Idea of filtering the power source.
- Comparision of ESP32 with S2 reference schematic.
- [cp2102n errata: problem with silicon](https://www.silabs.com/documents/public/errata/cp2102n-errata.pdf)
- Addition of transistors.
- We added a 2 pin header, it won't be fitted but can be used for short circuiting and use this circuit by ourselves manually by adding a GPIO23 pin.
- Adding titles to each circuit block makes the schematic a lot more professional.
- Reset annotations, add annotations to some parts manually. Then keep the existing annotations and then annotate other parts so that we don't need to annotate manually.
- Place the not connected flags on the pins that you don't use.
- You will get multiple errors saying that a wire has multiple net labels. How to fix that? Well, I just went ahead with PCB designing.
## PCB Designing
- You can change the board outline however you want. Starting point: x=1000, y=1000, width=2500, height=800.
- Units changed to mil.
- 100 mil grid size and snap size of 5.
- Parts being placed on bottom layer: header pins.
- ESP module placed on the top layer.
- You can measure the distance between parts too, so that you make sure you have placed the parts correctly.
- While watching any tutorial, make sure you see X-position and Y-position, not the mouse position. Because the X and Y positions refer to the centre of the part and its easier to refer to it.
- USB to UART chip's pin 1 to be on the bottom right corner.
- Cross probe and place directly on to the PCB, so that you don't waste time finding the part.
- Know where parts are placed in the schematic, similary place the components on the PCB. Ex: A capacitor is connected a voltage source in the schematic, so place that capacitor near the voltage pin.
- Two labels of the resistors which I placed have the labels (gnd and gnd) on them. Even though the connections are proper in the schematic, why is it like this? Is is wrong?
- For 5_ext volts external supply, it is correct, but for 3V it is wrong. Is +3V3 shorted somewhere?
- Well, you need to update PCB in desgin tab. Only then changes will be reflected on to the PCB. Only saving files won't work.
- No space on the top layer? Place on the bottom layer and close to where the part is connected.
- No stubs: It helps the quality of the signal
- While editing in bottom layer, the parts should also be in bottom layer configuration. Just remember this, or else you will end up placing the part on top layer.
- While designing the PCB, we also need to check the manufacturer's capabilities.
- [JLCPCB capabilites](https://jlcpcb.com/capabilities/pcb-capabilities)
- Things to check: minimum via hole size.
- We added 2 more layers, now in total: 4. You can change in Layer manager.
- One layer connected to +3V3 and another to gnd.
- Placed vias for the entire ESP32 Module.
- For tracks, if there isn't enough space, you can add a via and then continue on bottom layer.
- Connected all pins of ESP32 to header pins.
- A cross mark of yellow color indicate there is something wrong with tracing and it is too close to a component or even overlapping.
- We can even add custom coloring to labels so that we can easily identify gnd, voltage sources etc. This is so useful!!!!
- Place ground vias before itself so that later, you don't have to reroute your tracks.
- Rerouting the tracks is a pain.
- At an intersection a label was accidently placed on ground whereas it should have been placed on RXD0.
- Pins of USB connector were very close, so routing was not possible.
- Change the clearance from 10 to 8 mil in design tab->design rule. This way you will be able to route with more than enough track width.
- Don't forget to change the clearance back to 10 mil. We want the rest of the board to have 10 mil clearance.
- Press spacebar to rotate the suggested orientation of the track.
- Most of the times, try placing the vias on the same level. So that routing becomes easier.
- Sometimes one via is not enough, multiple vias may be need for power.
## Updating PCB
- Also update tracks net option should be checked. It should be selected.
- If you have ever forgotten and connections, look out for thin blue lines which indicate they need to be connected.
- Search for USB impedance. It is recommended to use 90 ohm differential pair impedance for USB tracks.
- Search for JLCPCB Stackup. [Website](https://jlcpcb.com/impedance)
- 3313, 1.6 mm, differential, 4layer, trace space is 4.
- [Impedance Calculator](https://jlcpcb.com/pcb-impedance-calculator)
- Addition of a new rule for our benefit.
- You can select for which pins they apply to.
- Why is it good to use vias for all the ground connections.
- Before checking DRC, adjust the design of clearance from 10 mil to 8 mil.
- Got from 50 DRC Errors to just 8. More than this, its almost impossible to correct the remaining.
## DRC Checks
- Got to zero DRC errors.
- Had to remove some vias.
## Drawing Polygons
- First we drew a polygon for ground connections.
- Pad Connection: Direct
- Rebuild copper area updates the polygon shape if changed not refresh or save file.
- Drew polygons for few: +3V3, GND and +5V.
## Standard Impedance
- 50 ohms seems to be standard and using the impedance calculator, it turns out, 6 mil should be the track width.
- Generally, power and ground tracks require larger track widths. So we chose 21 mil here.
- Transistors are thin, so we use 12 mil there.
## Adding Text
- Be sure to add text only on Top Silk Layer.
- Add pin no.s in some places so that it's easier to know where the starting point is.
- Solid regions after every 5 header pin slots will help a lot!
- This should be done on Top Silk Layer.
- Adding product name, company name, some ads.
## Manufacturing
- Generated Gerber file.
- WinRAR zip files work.
- 25 pieces cost 2200 rupees.
- 50: 2500 and so on
- Impedance control: 3313
- Ordering of layers
- Generation of BOM and saving as CSV files
- Export Pick and Place file
- Enable the assembly, assemble only on the top side.
- Confirm parts placement.
- Upload the BOM and pick and place file.
- Make sure every part is in stock and proceed.
- For components which are not fitted, remove them from the BOM and order them on `Farnell` or `DigiKey`
## After Receiving
- Check for any short circuit
- Check anode and cathode of LEDs
- Check with multimeter, the resistance of power rails, it must not be short circuit.
- Download Arduino software.
- [ESP 32 Tutorial](https://dronebotworkshop.com/esp32-intro/)
- Tools->Board->ESP32 Dev Module
- Device Manager->Connect the board with USB, then check which COM.
- A simple LED program
- A complex WiFi example. We will be able to control LED with a website!
